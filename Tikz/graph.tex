% -*- coding:utf-8 -*-
\documentclass{standalone}
\usepackage{fontspec}
\setmainfont{Times New Roman}
\usepackage[UTF8]{ctex}
\usepackage{tikz}
\usepackage{amsmath}
\usetikzlibrary{matrix,calc,shapes,backgrounds,patterns,positioning,decorations.pathreplacing}
\begin{document}
\begin{tikzpicture}
[
startstoprec/.style={rectangle, rounded corners=3mm, draw, fill=none, font=\small},
]
\draw[startstoprec] (0,0.25) rectangle (3,1.25) node[align=center] at (1.5,0.75){PointRDD \\ (用户位置信息)};
\draw[fill=lightgray!50] (4,0.25) rectangle (7, 1.25) node[align=center, font=\small] at (5.5, 0.75) {城市$j$边界 \\ $Contains$查询};
\draw[fill=lightgray!50] (8,0.25) rectangle (11, 1.25) node[align=center, font=\small] at (9.5, 0.75) {城市$i$ \\ 用户数量};
\draw[very thick,->] (3,0.75) -- (4, 0.75);
\draw[very thick, ->] (7,0.75) -- (8, 0.75);
\draw[very thick, ->] (9.5, 1.25) -- (9.5, 1.6) -- (5.5,1.6) -- (5.5, 1.25);
\draw[very thick, style=dashed] (3.5, -0.05) rectangle (11.5, 2.05);
\draw[very thick, ->] (7.5, -0.05) -- (7.5, -1.3) node[pos=0.5, right]{$E_{ij}$};
\draw[startstoprec] (6, -2.3) rectangle (9, -1.3) node at (7.5, -1.8){Graph};
\end{tikzpicture}
\end{document}